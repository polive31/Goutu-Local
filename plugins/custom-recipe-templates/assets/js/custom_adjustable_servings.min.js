var wpurp_adjustable_servings={};jQuery(document).ready(function(){jQuery(document).on("click","#servings .qty",function(){var e=jQuery(this),t=e.parent().find("input"),a=t.val();if("inc"==e.attr("id"))var r=parseFloat(a)+1;else if(a>1)r=parseFloat(a)-1;else r=1;t.val(r),t.trigger("change")}),jQuery(document).on("keyup change",".adjust-recipe-servings",function(e){var t=jQuery(this);console.log("In adjust recipe servings keyup change");var a=t.parents(".wpurp-container").find(".wpurp-recipe-ingredient-quantity"),r=parseFloat(t.data("original")),i=t.val();(isNaN(i)||i<=0)&&(i=1),wpurp_adjustable_servings.updateAmounts(a,r,i),wpurp_adjustable_servings.updateShortcode(t.parents(".wpurp-container"),i),RecipePrintButton.update(t.parents(".wpurp-container"))}),jQuery(document).on("blur",".adjust-recipe-servings",function(e){var t=jQuery(this),a=t.val();(isNaN(a)||a<=0)&&(a=1),t.parents(".wpurp-container").find(".adjust-recipe-servings").each(function(){jQuery(this).val(a)}),RecipePrintButton.update(t.parents(".wpurp-container"))})}),wpurp_adjustable_servings.updateShortcode=function(e,t){var a=parseFloat(e.data("servings-original"));e.find(".wpurp-adjustable-quantity").each(function(){var e=jQuery(this);if(void 0===e.data("original_quantity")){var r=wpurp_adjustable_servings.parse_quantity(e.text());r/=a,e.data("original_quantity",e.text()).data("unit_quantity",r)}if(t==a)e.text(e.data("original_quantity"));else{r=parseFloat(e.data("unit_quantity"))*t;isNaN(r)||e.text(wpurp_adjustable_servings.toFixed(r,!1))}})},wpurp_adjustable_servings.parse_quantity=function(e){e=e.replace(",",".");var t={"¼":" 1/4","½":" 1/2","¾":" 3/4","⅐":" 1/7","⅑":" 1/9","⅒":" 1/10","⅓":" 1/3","⅔":" 2/3","⅕":" 1/5","⅖":" 2/5","⅗":" 3/5","⅘":" 4/5","⅙":" 1/6","⅚":" 5/6","⅛":" 1/8","⅜":" 3/8","⅝":" 5/8","⅞":" 7/8"},a=(e=(e=(e+"").replace(/(\u00BC|\u00BD|\u00BE|\u2150|\u2151|\u2152|\u2153|\u2154|\u2155|\u2156|\u2157|\u2158|\u2159|\u215A|\u215B|\u215C|\u215D|\u215E)/,function(e,a){return t[a]})).trim()).split(" "),r=!1;if(""!==e){r=0;for(var i=0;i<a.length;i++)if(""!==a[i].trim()){var n=a[i].split("/",2),u=parseFloat(n[0]);if(void 0!==n[1]){var s=parseFloat(n[1]);0!==s&&(u/=s)}r+=u}}return r},wpurp_adjustable_servings.updateAmounts=function(e,t,a){e.each(function(){var e=parseFloat(jQuery(this).data("normalized")),r=jQuery(this).data("fraction");if(t==a)jQuery(this).text(jQuery(this).data("original"));else if(isFinite(e)){var i=a*e/t,n=wpurp_adjustable_servings.toFixed(i,r);jQuery(this).text(n+" ")}else jQuery(this).addClass("recipe-ingredient-nan")})},wpurp_adjustable_servings.toFixed=function(e,t){if(t){var a=Fraction(e.toString()).snap();if(a.denominator<100)return a}if(""==e||0==e)return"";for(var r=parseInt(wpurp_servings.precision),i=e.toFixed(r);0==parseFloat(i);)if(r++,i=e.toFixed(r),r>10)return"";if(r>0){var n=Array(r+1).join("0");i=i.replace(new RegExp("."+n+"$"),"")}return"undefined"!=typeof wpurp_servings&&(i=i.replace(".",wpurp_servings.decimal_character)),i};