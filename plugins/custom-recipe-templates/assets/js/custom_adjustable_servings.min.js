var wpurp_adjustable_servings={};jQuery(document).ready(function(){console.log("In custom adjustable servings script"),jQuery(document).on("click",".recipe-input i",function(){console.log("Portion ajustment button click");var t=jQuery(this),e=t.parent().find("input"),a=e.val();if("inc"==t.attr("id"))var r=parseFloat(a)+1;else if(a>1)r=parseFloat(a)-1;else r=1;e.val(r),e.trigger("change")}),jQuery(document).on("keyup change",".adjust-recipe-servings",function(t){var e=jQuery(this),a=e.parents(".wpurp-container").find(".wpurp-recipe-ingredient-quantity"),r=parseFloat(e.data("original")),i=e.val();(isNaN(i)||i<=0)&&(i=1),wpurp_adjustable_servings.updateAmounts(a,r,i),wpurp_adjustable_servings.updateShortcode(e.parents(".wpurp-container"),i),RecipePrintButton.update(e.parents(".wpurp-container"))}),jQuery(document).on("blur",".adjust-recipe-servings",function(t){var e=jQuery(this),a=e.val();(isNaN(a)||a<=0)&&(a=1),e.parents(".wpurp-container").find(".adjust-recipe-servings").each(function(){jQuery(this).val(a)}),RecipePrintButton.update(e.parents(".wpurp-container"))})}),wpurp_adjustable_servings.updateShortcode=function(t,e){var a=parseFloat(t.data("servings-original"));t.find(".wpurp-adjustable-quantity").each(function(){var t=jQuery(this);if(void 0===t.data("original_quantity")){var r=wpurp_adjustable_servings.parse_quantity(t.text());r/=a,t.data("original_quantity",t.text()).data("unit_quantity",r)}if(e==a)t.text(t.data("original_quantity"));else{r=parseFloat(t.data("unit_quantity"))*e;isNaN(r)||t.text(wpurp_adjustable_servings.toFixed(r,!1))}})},wpurp_adjustable_servings.parse_quantity=function(t){t=t.replace(",",".");var e={"¼":" 1/4","½":" 1/2","¾":" 3/4","⅐":" 1/7","⅑":" 1/9","⅒":" 1/10","⅓":" 1/3","⅔":" 2/3","⅕":" 1/5","⅖":" 2/5","⅗":" 3/5","⅘":" 4/5","⅙":" 1/6","⅚":" 5/6","⅛":" 1/8","⅜":" 3/8","⅝":" 5/8","⅞":" 7/8"},a=(t=(t=(t+"").replace(/(\u00BC|\u00BD|\u00BE|\u2150|\u2151|\u2152|\u2153|\u2154|\u2155|\u2156|\u2157|\u2158|\u2159|\u215A|\u215B|\u215C|\u215D|\u215E)/,function(t,a){return e[a]})).trim()).split(" "),r=!1;if(""!==t){r=0;for(var i=0;i<a.length;i++)if(""!==a[i].trim()){var n=a[i].split("/",2),u=parseFloat(n[0]);if(void 0!==n[1]){var s=parseFloat(n[1]);0!==s&&(u/=s)}r+=u}}return r},wpurp_adjustable_servings.updateAmounts=function(t,e,a){t.each(function(){var t=parseFloat(jQuery(this).data("normalized")),r=jQuery(this).data("fraction");if(e==a)jQuery(this).text(jQuery(this).data("original"));else if(isFinite(t)){var i=a*t/e,n=wpurp_adjustable_servings.toFixed(i,r);jQuery(this).text(n+" ")}else jQuery(this).addClass("recipe-ingredient-nan")})},wpurp_adjustable_servings.toFixed=function(t,e){if(e){var a=Fraction(t.toString()).snap();if(a.denominator<100)return a}if(""==t||0==t)return"";for(var r=parseInt(wpurp_servings.precision),i=t.toFixed(r);0==parseFloat(i);)if(r++,i=t.toFixed(r),r>10)return"";if(r>0){var n=Array(r+1).join("0");i=i.replace(new RegExp("."+n+"$"),"")}return"undefined"!=typeof wpurp_servings&&(i=i.replace(".",wpurp_servings.decimal_character)),i};