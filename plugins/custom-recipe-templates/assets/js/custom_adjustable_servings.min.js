var wpurp_adjustable_servings={};jQuery(document).ready(function(){jQuery("tooltip").oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},jQuery(document).on("click","#servings .qty",function(){var e=jQuery(this),t=e.parent().find("input"),r=t.val();if("inc"==e.attr("id"))var a=parseFloat(r)+1;else if(r>1)a=parseFloat(r)-1;else a=1;t.val(a),t.trigger("change")}),jQuery(document).on("keyup change",".adjust-recipe-servings",function(e){var t=jQuery(this);console.log("In adjust recipe servings keyup change");var r=t.parents(".wpurp-container").find(".wpurp-recipe-ingredient-quantity"),a=parseFloat(t.data("original")),i=t.val();(isNaN(i)||i<=0)&&(i=1),wpurp_adjustable_servings.updateAmounts(r,a,i),wpurp_adjustable_servings.updateShortcode(t.parents(".wpurp-container"),i),RecipePrintButton.update(t.parents(".wpurp-container"))}),jQuery(document).on("blur",".adjust-recipe-servings",function(e){var t=jQuery(this),r=t.val();(isNaN(r)||r<=0)&&(r=1),t.parents(".wpurp-container").find(".adjust-recipe-servings").each(function(){jQuery(this).val(r)}),RecipePrintButton.update(t.parents(".wpurp-container"))})}),wpurp_adjustable_servings.updateShortcode=function(e,t){var r=parseFloat(e.data("servings-original"));e.find(".wpurp-adjustable-quantity").each(function(){var e=jQuery(this);if(void 0===e.data("original_quantity")){var a=wpurp_adjustable_servings.parse_quantity(e.text());a/=r,e.data("original_quantity",e.text()).data("unit_quantity",a)}if(t==r)e.text(e.data("original_quantity"));else{a=parseFloat(e.data("unit_quantity"))*t;isNaN(a)||e.text(wpurp_adjustable_servings.toFixed(a,!1))}})},wpurp_adjustable_servings.parse_quantity=function(e){e=e.replace(",",".");var t={"¼":" 1/4","½":" 1/2","¾":" 3/4","⅐":" 1/7","⅑":" 1/9","⅒":" 1/10","⅓":" 1/3","⅔":" 2/3","⅕":" 1/5","⅖":" 2/5","⅗":" 3/5","⅘":" 4/5","⅙":" 1/6","⅚":" 5/6","⅛":" 1/8","⅜":" 3/8","⅝":" 5/8","⅞":" 7/8"},r=(e=(e=(e+"").replace(/(\u00BC|\u00BD|\u00BE|\u2150|\u2151|\u2152|\u2153|\u2154|\u2155|\u2156|\u2157|\u2158|\u2159|\u215A|\u215B|\u215C|\u215D|\u215E)/,function(e,r){return t[r]})).trim()).split(" "),a=!1;if(""!==e){a=0;for(var i=0;i<r.length;i++)if(""!==r[i].trim()){var n=r[i].split("/",2),u=parseFloat(n[0]);if(void 0!==n[1]){var s=parseFloat(n[1]);0!==s&&(u/=s)}a+=u}}return a},wpurp_adjustable_servings.updateAmounts=function(e,t,r){e.each(function(){var e=parseFloat(jQuery(this).data("normalized")),a=jQuery(this).data("fraction");if(t==r)jQuery(this).text(jQuery(this).data("original"));else if(isFinite(e)){var i=r*e/t,n=wpurp_adjustable_servings.toFixed(i,a);jQuery(this).text(n+" ")}else jQuery(this).addClass("recipe-ingredient-nan")})},wpurp_adjustable_servings.toFixed=function(e,t){if(t){var r=Fraction(e.toString()).snap();if(r.denominator<100)return r}if(""==e||0==e)return"";for(var a=parseInt(wpurp_servings.precision),i=e.toFixed(a);0==parseFloat(i);)if(a++,i=e.toFixed(a),a>10)return"";if(a>0){var n=Array(a+1).join("0");i=i.replace(new RegExp("."+n+"$"),"")}return"undefined"!=typeof wpurp_servings&&(i=i.replace(".",wpurp_servings.decimal_character)),i};