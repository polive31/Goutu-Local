var RecipePrintButton=RecipePrintButton||{};RecipePrintButton.update=function(e){e.find(".wpurp-recipe-print-button").each(function(){var t=jQuery(this),r=t.data("original-link");r||(r=t.attr("href"),t.data("original-link",r));var i=wpurp_print.permalinks?"/":"=";r.slice(-1)!=i&&(r+=i);var n=e.find("select.adjust-recipe-unit:visible option:selected").text();n&&(r+=n.toLowerCase().replace(/ /g,"-").replace(/[-]+/g,"-").replace(/[^\w-]+/g,"")+"/");var p=e.find("input.adjust-recipe-servings:visible");0==p.length&&(p=e.find("input.advanced-adjust-recipe-servings:visible")),0!=p.length&&(r+=p.val()),t.attr("href",r)})},jQuery(document).ready(function(){jQuery(document).on("click",".wpurp-recipe-print-button, .wpurp-print-recipe-shortcode",function(e){var t=jQuery(this).data("recipe-id");if(t){e.preventDefault(),e.stopPropagation();var r=jQuery(this).parents(".wpurp-container");wpurp_print.servings_original=parseFloat(r.data("servings-original")),wpurp_print.old_system=parseInt(r.data("system-original")),wpurp_print.new_system=r.find("select.adjust-recipe-unit option:selected").val(),wpurp_print.rtl=jQuery("body").hasClass("rtl");var i=r.find("input.adjust-recipe-servings");0==i.length&&(i=r.find("input.advanced-adjust-recipe-servings")),0==i.length?wpurp_print.servings_new=wpurp_print.servings_original:wpurp_print.servings_new=parseFloat(i.val()),wpurp_print.template="";var n={action:"get_recipe_template",security:wpurp_print.nonce,recipe_id:t};jQuery.post(wpurp_print.ajaxurl,n,function(e){wpurp_print.template=e.output,wpurp_print.fonts=e.fonts},"json"),window.open(wpurp_print.coreUrl+"/templates/print.php","_blank")}})});