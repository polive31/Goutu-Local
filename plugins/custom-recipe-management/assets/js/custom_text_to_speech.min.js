var tts={step:0,thisBullet:jQuery(""),playing:!1,lastStep:0};jQuery(document).ready((function(){tts.lastStep=jQuery("li.wpurp-recipe-instruction").length-1,jQuery(document).on("click",".toolbar-button#read",(function(e){e.preventDefault(),e.stopPropagation(),tts.openReader()})),jQuery(document).on("click",".recipe-instruction-bullet",(function(e){e.preventDefault(),e.stopPropagation(),tts.step=jQuery(this).attr("id").match(/\d+$/),tts.openReader()})),jQuery(document).on("click","#custom-reader-repeat",(function(e){e.preventDefault(),e.stopPropagation(),tts.readStep()})),jQuery(document).on("click","#custom-reader-pause, #custom-reader-play",(function(e){e.preventDefault(),e.stopPropagation(),tts.toggleStep()})),jQuery(document).on("click","#custom-reader-prev",(function(e){e.preventDefault(),e.stopPropagation(),tts.step>0&&tts.step--,tts.readStep()})),jQuery(document).on("click","#custom-reader-next",(function(e){e.preventDefault(),e.stopPropagation(),tts.step<tts.lastStep&&tts.step++,tts.readStep()})),jQuery(window).unload((function(){jQuery("#custom-reader-stop").click()})),jQuery(document).on("click","#custom-reader-stop",(function(e){e.preventDefault(),e.stopPropagation(),tts.step=0,tts.closeReader()})),jQuery(document).on("click","#responsive-menu-pro-button",(function(e){e.preventDefault(),e.stopPropagation(),tts.step=0,tts.closeReader()}))})),tts.openReader=function(){var reader=jQuery("#custom-reader-container");reader.length||(reader=jQuery('<div class="wrapper"></div>'),play=jQuery('<span id="custom-reader-play" class="custom-reader-icon" title="'+recipeRead.title.play+'">'+recipeRead.icon.play+"</span>"),pause=jQuery('<span id="custom-reader-pause" class="custom-reader-icon" title="'+recipeRead.title.pause+'">'+recipeRead.icon.pause+"</span>").hide(),repeat=jQuery('<span id="custom-reader-repeat" class="custom-reader-icon" title="'+recipeRead.title.repeat+'">'+recipeRead.icon.repeat+"</span>").hide(),prev=jQuery('<span id="custom-reader-prev" class="custom-reader-icon" title="'+recipeRead.title.prev+'">'+recipeRead.icon.prev+"</span>"),next=jQuery('<span id="custom-reader-next" class="custom-reader-icon" title="'+recipeRead.title.next+'">'+recipeRead.icon.next+"</span>"),stop=jQuery('<span id="custom-reader-stop" class="custom-reader-icon" title="'+recipeRead.title.stop+'">'+recipeRead.icon.stop+"</span>"),reader.append(prev).append(play).append(pause).append(repeat).append(next).append(stop),reader=jQuery('<div id="custom-reader-container"></div>').append(reader),jQuery("body").append(reader)),reader.addClass("open"),tts.readStep()},tts.closeReader=function(){var reader=jQuery("#custom-reader-container");reader.length>0&&(reader.clearQueue(),reader.removeClass("open")),tts.thisBullet.removeClass("reading read"),tts.cancel()},tts.readStep=function(){var instructions=jQuery(document).find("ul.wpurp-recipe-instruction-container"),thisInstruction=instructions.find("#wpurp_recipe_instruction"+tts.step),thisText=thisInstruction.find(".recipe-instruction-text").text();tts.thisBullet.removeClass("reading read"),tts.thisBullet=instructions.find("#recipe-instruction-bullet"+tts.step),tts.thisBullet.addClass("reading"),jQuery(window).scrollTop(jQuery("#recipe-instruction-bullet"+tts.step).offset().top-thisInstruction.height()-200),tts.play(thisText)},tts.toggleStep=function(){tts.toggle()},tts.readStepBegins=function(){jQuery("#custom-reader-pause").show(),jQuery("#custom-reader-play").hide(),jQuery("#custom-reader-repeat").hide()},tts.readStepEnds=function(){jQuery("#custom-reader-pause").hide(),jQuery("#custom-reader-play").hide(),jQuery("#custom-reader-repeat").show(),tts.thisBullet.removeClass("reading"),tts.thisBullet.addClass("read")},tts.play=function(text){var voice=recipeRead.voice;tts.playing=!0,responsiveVoice.speak(text,voice,{onstart:tts.readStepBegins,onend:tts.readStepEnds})},tts.toggle=function(){console.log("In toggle "),tts.playing?(jQuery("#custom-reader-pause").hide(),jQuery("#custom-reader-play").show(),tts.playing=!1,responsiveVoice.pause()):(jQuery("#custom-reader-pause").show(),jQuery("#custom-reader-play").hide(),tts.playing=!0,responsiveVoice.resume())},tts.cancel=function(){tts.playing=!1,responsiveVoice.cancel()};